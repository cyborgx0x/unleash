{% extends "base.html" %}
{% block title %}Kh√°m Ph√°{% endblock %}
{% block content %}
<script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>
<div class="row row-cards">

  <div class="col-md-8">
      {% for fiction in top_view_fictions %}
      <div class="col-6 col-md-2">

        {% include '_fiction.html'  %}   
        </div>
      {% endfor %}
  </div>
  <div class="col-md-4">
    <div class="row row-cards">
      <span class="badge bg-cyan">T√°c gi·∫£ ƒë∆∞·ª£c ƒë·ªÅ xu·∫•t</span>
        {% for author in top_authors %} 
            {% include '_homeitemrectangle.html'  %}
        {% endfor %}
    </div>
  </div>
  <script>
    function changeState(context) {  
        if (context.value=="follow") {
            context.value="followed"
            context.textContent = "ƒê√£ theo d√µi üíÅ‚Äç‚ôÇÔ∏è"
            uploadData(context)
        }
        else {
            context.value="follow"
            context.textContent = "Theo d√µi üíéüíéüíé"
            uploadData(context)
        }
    }
    function uploadData(context) {
        let data = {type:"author-follow", value:context.value, author:context.name}
        console.log(data)
        axios.post('/api/following/author/', {data:data}).then((res)=>{
            console.log(res)
            context.previousSibling.previousSibling.innerHTML = res.data
            console.log(context.previousSibling)
        }).catch((err)=>{
            context.textContent = "ƒê√£ c√≥ l·ªói x·∫£y ra"
            context.disabled = true
        })
                
    }
  </script>
{% endblock %}