{% extends "base.html" %}
{% block title %}{{chapter.name}} - {{fiction.name}}{% endblock %}
{% block search %}
{% endblock %}

{% block nav %}
{{super()}}

{% endblock %}
{% block style %}

<style>
@media (min-width: 768px) {
  .form-select{
    width: 400px;
    display:inline-flex;
  }
}
.card-title{
  display: inline-flex;
}
.form-select{
  width: 150px;
  display:inline-flex;
}
.option-button{
  align-items: flex-start;
  position: absolute;
}
.card-header {
  display: grid;
}
.user-action{
  color: white;
  margin:3px;
  display: flex;
  flex-direction: column;
  width: fit-content;
  position: fixed;
  border-radius: 5px;

}

.user-action >.btn {
  padding:5px;
  padding-left: 15px;
  margin-bottom: 10px;
}
.markdown {
  font-size: 1rem;
}
</style>

{% endblock %}
{% block content%}


<div class="row justify-content-center">
  
  <center>
  {% include '_navigation.html'  %}

  </center>
  <div class="col-md-9">
    
      <div class="modal fade" id="Editable" tabindex="-1" role="dialog"
      aria-labelledby="exampleModalCenterTitle" aria-hidden="true">
      {% include '_searchmodal.html'  %} 
      </div>
  
    <div class="card card-lg" style="margin: 10;">
      <div class="col-xl-2 col-sm-4">
      </div>
      <div class="card-header justify-content-center">

        <div class="option-button">
          <a type="button" class="btn dropdown-toggle" data-bs-toggle="dropdown">
            Tùy chọn 
          </a>
          <div class="dropdown-menu dropdown-menu-demo dropdown-menu-arrow bg-dark text-white">
              <a href="{{url_for('new_chapter', fiction_id=fiction.id)}}" class="dropdown-item btn  btn-primary" type="button">
                <svg xmlns="http://www.w3.org/2000/svg" class="icon" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M9 4h6a2 2 0 0 1 2 2v14l-5 -3l-5 3v-14a2 2 0 0 1 2 -2" /></svg>
                Đánh dấu chương này</a>
              <a href="{{url_for("edit_specific_post", fiction_id=fiction.id)}}" class="dropdown-item">Chỉnh sửa chương truyện</a>
              <a href="{{url_for("delete_fiction", fiction_id=fiction.id)}}" class="dropdown-item">Xóa chương này</a>
              <a href="#" data-toggle="modal" data-target="#Editable" class="dropdown-item">
                Search Function
              </a>
          </div>
        </div>
        <div class="card-title">
          {{ chapter.name }}
        </div>

      </div>
      <div class="card-body">



        <div id="fictionID" data="{{fiction.id}}"></div>
        <div id="currentChapter" data="{{chapter.id}}"></div>
        <div class="card-title" id="exampleModalLabel"></div>
        
        <div class="markdown" id=viewerContent>
         
          
        </div>
        <script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>

        <script>
          axios.get('{{url_for("api_chapter_id", chapter_id = chapter.id)}}').then(function(response) {
            console.log(response)
            document.getElementById('viewerContent').innerHTML = response.data.content.replace(/(?:\r\n|\r|\n)/g, '<br>');
          })
        </script>
      </div>
    </div>
    <center>
      {% include '_navigation.html'  %}
    </center>
  </div>

</div>

</div>


{% endblock %}