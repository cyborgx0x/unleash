{% extends "layout.html" %}
{% block title %}{{ fiction.name }} by {{ author.name }}{% endblock %}

{% block layoutleft %}
<div  style="margin:5px">
    <div class="bg-dark text-white">
        <a class="dropdown-item" href="/fiction/{{fiction.id}}">Xem trang t√°c ph·∫©m</a>
        <button class="dropdown-item" onclick="showMedia(this)" value="edit-fiction">Ch·ªânh s·ª≠a th√¥ng tin</button>
        <button class="dropdown-item" onclick="showMedia(this)" value="manage-chapter">Qu·∫£n l√Ω ch∆∞∆°ng</button>
        <button class="dropdown-item" onclick="showMedia(this)" value="edit-foreword">Ch·ªânh s·ª≠a l·ªùi t·ª±a üìù</button>
        <button class="dropdown-item" onclick="showMedia(this)" value="">C√†i ƒë·∫∑t chung</button>
        <button class="dropdown-item" onclick="showMedia(this)" value="">Page and Media</button>
        <button class="dropdown-item" onclick="showMedia(this)" value="">Th·ªëng k√™</button>
        <button class="dropdown-item" onclick="showMedia(this)" value="">L·ªãch s·ª≠ ch·ªânh s·ª≠a</button>
    </div>
</div>
{% endblock %}
{% block layoutcenter %}

<div class="card"> 
    <div class="card-body">
        
        <div class="tab-content" id="tab-content">
            <div class="tab-pane" id="manage-chapter">
                <div>
                    <a  class="btn" href={{url_for('new_chapter', fiction_id=fiction.id)}}>T·∫°o Ch∆∞∆°ng M·ªõi</a>
                </div>
                <h2>B·∫•m v√†o link ƒë·ªÉ ch·ªânh s·ª≠a ch∆∞∆°ng</h2>
                {% for chapter in chapters %}
                <li class="dropdown-item">  
                    <a href="{{url_for('edit_chapter', chapter_id=chapter.id)}}" class="link-info large">{{chapter.name}}</a> 
                    <a href="{{url_for('delete_chapter', chapter_id=chapter.id)}}" style="position: relative; padding-left:30px ">X√≥a ch∆∞∆°ng n√†y</a>
                </li>                
                {% endfor %}
            </div>
            <div class="tab-pane" id="edit-foreword">
                <div class="toast-body" id="update_message">
                    Vui l√≤ng nh·∫•n n√∫t ƒë·ªÉ l∆∞u
                </div>
                <button id="saveButton" class="btn btn-success">
                    <!-- Download SVG icon from http://tabler-icons.io/i/send -->
                    <svg xmlns="http://www.w3.org/2000/svg" class="icon" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><line x1="10" y1="14" x2="21" y2="3" /><path d="M21 3l-6.5 18a0.55 .55 0 0 1 -1 0l-3.5 -7l-7 -3.5a0.55 .55 0 0 1 0 -1l18 -6.5" /></svg>
                    Save
                </button>
                <div id="editorjs"></div>
                {% include "_editorjs.html" %} 
            </div>
            <div class="tab-pane active show" id="edit-fiction">
                <div class="alert" role="alert" id="alert-theme">
                    <h4 class="alert-heading"  id="alert-information"> M·ªói m·ª•c ƒë·ªÅu ri√™ng bi·ªát. Khi ch·ªânh s·ª≠a xong vui l√≤ng nh·∫•n enter </h4>
                </div>
                <div class="form-group">
                    <label for="fiction_name">Ti√™u ƒë·ªÅ t√°c ph·∫©m</label>
                    <input type="text" class="form-control" name="fiction_name" id="fiction_name" value="{{fiction.name}}">
                    <label for="publist_year">NƒÉm xu·∫•t b·∫£n</label>
                    <input type="text" class="form-control" name="publish_year" id="publish_year" value="{{fiction.publish_year}}">
                    <label for="tag-manage">Th·ªÉ lo·∫°i</label>
                    <input type="text" name="tag-manage" id="tag-manage" value="{{fiction.tag}}" class="form-control">
                    <label for="link-download">Link t·∫£i s√°ch</label>
                    <input type="text" name="link-download" id="link-download" value="{{fiction.mediafire_link}}" class="form-control">
                    <label for="book-cover">B√¨a s√°ch</label>
                    <input type="text" name="book-cover" id="book-cover" value="{{fiction.cover}}" class="form-control">
                </div>
            </div>
        </div>
    </div>
</div>
<script>
    
    let input = document.getElementById('edit-fiction').querySelectorAll('.form-control')
    console.log(input)
    for (let i=0; i<input.length;i++) {
        console.log(input[i])
        input[i].addEventListener('change', (e)=>{
            console.log(e.target.name)
            axios.post('', {type:e.target.name, value:e.target.value})
            .then((res)=>{
                console.log(res);
                document.getElementById('alert-information').textContent='Result: ' + res.data;
                document.getElementById('alert-theme').className = 'alert alert-success';
            })
            .catch((err)=>{
                console.log(err.message);
                document.getElementById('alert-information').textContent=err.message
                document.getElementById('alert-theme').className = 'alert alert-danger'
            })
        })
    }
    function saveContent(context) {
        console.log('test')
    }
</script>
{% endblock %}
{% block layoutright %}

{% endblock %}